<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>{{{ PRODUCT_NAME }}}</title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico">
    <link rel="stylesheet" href="TemplateData/style.css">
    <link rel="manifest" href="manifest.webmanifest">
  </head>
  <body>
    <div id="unity-container">
      <canvas id="unity-canvas" width={{{ WIDTH }}} height={{{ HEIGHT }}} tabindex="-1"></canvas>
      <div id="unity-loading-bar">
        <div id="unity-logo"></div>
        <div id="unity-progress-bar-empty">
          <div id="unity-progress-bar-full"></div>
        </div>
      </div>
      <div>
        <script src="https://unpkg.com/@vkid/sdk@2.3.3/dist-sdk/umd/index.js"></script> 
        <script type="text/javascript"> 
        const userInfo = "";
          if ('VKIDSDK' in window) { 
            const VKID = window.VKIDSDK; 
      
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const code = urlParams.get('code');
            const deviceId = urlParams.get('device_id');

            if (code && deviceId) {
              let accessToken = VKID.Auth.exchangeCode(code, deviceId);
              let info = VKID.Auth.userInfo(accessToken);
              userInfo = JSON.stringify(info);
            }
            else {
              VKID.Config.init({ 
                app: 52387924, 
                redirectUrl: 'https://cityofsinners.ru', 
                source: VKID.ConfigSource.LOWCODE, 
                action: { 
                  name: `qr_auth`, 
              }
              });

              const floatingOneTap = new VKID.FloatingOneTap();
              floatingOneTap.render({
                appName: 'City Of Game',
                onSuccess: function () {
                  console.log('Authentification success');
                },
                onFailure: function (error) {
                  console.error('Authentification error:', error);
                }
              });
            }
          } 
          
          function vkidOnSuccess(data) { 
            console.log(`LogIn Success ${data}`);
          }
        
          function vkidOnError(error) { 
            console.log(`LogIn error: ${error}`);
          } 
        </script> 
      </div>
      <div id="unity-warning"> </div>
    </div>
    <script src="index.js"></script>
  </body>
</html>
